{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
	<title>SRT</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->	
	<link rel="icon" type="image/png" href="{% static 'Login/images/icons/favicon.ico' %}"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'Login/vendor/bootstrap/css/bootstrap.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'Login/fonts/font-awesome-4.7.0/css/font-awesome.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'Login/vendor/animate/animate.css' %}">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="{% static 'Login/vendor/css-hamburgers/hamburgers.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'Login/vendor/select2/select2.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'Login/css/util.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'Login/css/main.css' %}">
<!--===============================================================================================-->
</head>
<body>
	
	<div class="limiter"   >
		<div class="container-login100" style="background: #1F752B;">
			<div class="wrap-login100">
				<div class="login100-pic js-tilt" data-tilt>
				<img src="{% static 'img/taxi.png' %}" alt="IMG">
				</div>

				<div class="login100-form "  id="form-login" name="form-login"   method="post">
					 {% csrf_token %}
					<span class="login100-form-title">
						Radio Taxi Tabasco
					</span>

					<div class="wrap-input100 validate-input"  >
						<input class="input100" type="text" name="username" id="username" autocomplete="off" placeholder="Usuario">
						<span class="focus-input100"></span>
						<span class="symbol-input100">
							<i class="fa fa-user" aria-hidden="true"></i>
						</span>
					</div>

					<div class="wrap-input100 validate-input">
						<input class="input100" type="password" name="password" id="password" placeholder="Contraseña">
						<span class="focus-input100"></span>
						<span class="symbol-input100">
							<i class="fa fa-lock" aria-hidden="true"></i>
						</span>
					</div>
					<div class="text-center p-t-12">
						<span class="txt1" id="error" style="display: none; color: red"  >
						Usuario y/o Contraseña Incorrecto
				     </span>
					
					<div class="container-login100-form-btn ">
						<button class="login100-form-btn" id="iniciar"   style="background: #1F752B;"  >
							Iniciar Sesión
						</button>
					</div>
                    <br> <br>
				<!---	<div class="text-center p-t-12">
						<span class="txt1">
						¿Olvidó
						</span>
						<a class="txt2" href="#">
						
 su nombre de usuario / contraseña?
						</a>
					</div>--->

		
				</div>
			</div>
		</div>
	</div>
	
	

	
<!--===============================================================================================-->	
	<script src="{% static '/Login/vendor/jquery/jquery-3.2.1.min.js ' %}"></script>
<!--===============================================================================================-->
	<script src="{% static '/Login/vendor/bootstrap/js/popper.js ' %}"></script>
	<script src="{% static '/Login/vendor/bootstrap/js/bootstrap.min.js ' %}"></script>
<!--===============================================================================================-->
	<script src="{% static '/Login/vendor/select2/select2.min.js ' %}"></script>
<!--===============================================================================================-->
	<script src="{% static '/Login/vendor/tilt/tilt.jquery.min.js ' %}"></script>
	<script >
		$('.js-tilt').tilt({
			scale: 1.1
		})
	</script>
<!--===============================================================================================-->
	<script src="{% static '/Login/js/main.js' %}"></script>
<script> 
    /*
      var nieve_cantidad=70;

// Colores de los copos se mostraran de forma aleatoria
var nieve_colorr=new Array("#aaaacc","#ddddFF","#ccccDD")

// Tipo de letra de los copos
var nieve_tipo=new Array("Arial Black","Arial Narrow","Times","Comic Sans MS")

// Valor o letra de los copos
var nieve_letra="*"

// velocidad de caida
var nieve_velocidad=1.0;

// tamaño mas grande de los copos
var nieve_cantidadsize=30

// tamaño mas pequeño de los copos
var nieve_chico=8

// 1 toda la pagina - 2 zona izquierda - 3 centro de pagina - 4 zona derecha
var nieve_zona=1

var nieve=new Array()
var marginbottom
var marginright
var timer
var i_nieve=0
var x_mv=new Array();
var crds=new Array();
var lftrght=new Array();
var browserinfos=navigator.userAgent
var ie5=document.all&&document.getElementById&&!browserinfos.match(/Opera/)
var ns6=document.getElementById&&!document.all
var opera=browserinfos.match(/Opera/)  
var browserok=ie5||ns6||opera

function aleatorio(range) {    
    rand=Math.floor(range*Math.random())
    return rand
}

function initnieve() {
    if (ie5 || opera) {
        marginbottom = document.body.clientHeight
        marginright = document.body.clientWidth
    }
    else if (ns6) {
        marginbottom = window.innerHeight
        marginright = window.innerWidth
    }
    var nievesizerange=nieve_cantidadsize-nieve_chico
    for (i=0;i<=nieve_cantidad;i++) {
        crds[i] = 0;                      
        lftrght[i] = Math.random()*15;        
        x_mv[i] = 0.03 + Math.random()/10;
        nieve[i]=document.getElementById("s"+i)
        nieve[i].style.fontFamily=nieve_tipo[aleatorio(nieve_tipo.length)]
        nieve[i].size=aleatorio(nievesizerange)+nieve_chico
        nieve[i].style.fontSize=nieve[i].size
        nieve[i].style.color=nieve_colorr[aleatorio(nieve_colorr.length)]
        nieve[i].sink=nieve_velocidad*nieve[i].size/5
        if (nieve_zona==1) {nieve[i].posx=aleatorio(marginright-nieve[i].size)}
        if (nieve_zona==2) {nieve[i].posx=aleatorio(marginright/2-nieve[i].size)}
        if (nieve_zona==3) {nieve[i].posx=aleatorio(marginright/2-nieve[i].size)+marginright/4}
        if (nieve_zona==4) {nieve[i].posx=aleatorio(marginright/2-nieve[i].size)+marginright/2}
        nieve[i].posy=aleatorio(2*marginbottom-marginbottom-2*nieve[i].size)
        nieve[i].style.left=nieve[i].posx + 'px';
        nieve[i].style.top=nieve[i].posy + 'px';
    }
    movenieve()
}

function movenieve() {
    for (i=0;i<=nieve_cantidad;i++) {
        crds[i] += x_mv[i];
        nieve[i].posy+=nieve[i].sink
        nieve[i].style.left=nieve[i].posx+lftrght[i]*Math.sin(crds[i]) + 'px';;
        nieve[i].style.top=nieve[i].posy + 'px';

        if (nieve[i].posy>=marginbottom-2*nieve[i].size || parseInt(nieve[i].style.left)>(marginright-3*lftrght[i])){
            if (nieve_zona==1) {nieve[i].posx=aleatorio(marginright-nieve[i].size)}
            if (nieve_zona==2) {nieve[i].posx=aleatorio(marginright/2-nieve[i].size)}
            if (nieve_zona==3) {nieve[i].posx=aleatorio(marginright/2-nieve[i].size)+marginright/4}
            if (nieve_zona==4) {nieve[i].posx=aleatorio(marginright/2-nieve[i].size)+marginright/2}
            nieve[i].posy=0
        }
    }
    var timer=setTimeout("movenieve()",50)
}

for (i=0;i<=nieve_cantidad;i++) {
    document.write("<span id='s"+i+"' style='position:absolute;top:-"+nieve_cantidadsize+"'>"+nieve_letra+"</span>")
}
if (browserok) {
    window.onload=initnieve
}

*/

 /*        $(document).bind("contextmenu",function(e){
        return false;
    });*/
$(document).ready(function(){


 


 $("#password").keyup(function (event) {

        if (event.keyCode == 13) { //Permite dar enter y ejecutar la función, cuando está posicionado sobre el txtLogin
    var username = $('#username').val();
    var password = $('#password').val();
    var remember_me = $('#input-local-storage').prop('checked');
    if(username && password) {
        console.log("Will try to login with ", username, password);
        $('#modal-error').addClass('d-invisible');
        $.ajax({
            url: g_urls.login,
            method: "POST",
            data: {
                username: username,
                password: password,
                csrfmiddlewaretoken: g_csrftoken
            }
        }).done(function(data) {
           
            g_auth = {
                username: username,
                key: data.key,
                remember_me: remember_me
            };  
            g_csrftoken = getCookie('csrftoken');
            document.location.href="panel/";
        }).fail(function(data) {
        	$("#error").show();
           setTimeout(function(){ $("#error").css("display","none"); }, 2000);
           
        });
    } 
    else { $('#modal-error').removeClass('d-invisible');
    }

        }



    });
});
    
    var g_urls = {
    'login': '{% url "rest_login" %}',
    'logout': '{% url "rest_logout" %}',
   
};
var g_auth = localStorage.getItem("auth");
if(g_auth == null) {
    g_auth = sessionStorage.getItem("auth");
}

if(g_auth) {
    try {
        g_auth = JSON.parse(g_auth);
    } catch(error) {
        g_auth = null;
    }
}

var getCookie = function(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
};
var g_csrftoken = getCookie('csrftoken');

var initLogin = function() {
    if(g_auth) {
        $('#non-logged-in').hide();
        $('#logged-in').show();
        $('#span-username').html(g_auth.username);
        if(g_auth.remember_me) {
            localStorage.setItem("auth", JSON.stringify(g_auth));
        } else {
            sessionStorage.setItem("auth", JSON.stringify(g_auth));
        }
    } else {
        $('#non-logged-in').show();
        $('#logged-in').hide();
        $('#span-username').html('');
        localStorage.removeItem("auth");
        sessionStorage.removeItem("auth");
    }
    $('#test-auth-response').html("");
}

$(function () {
    initLogin();

    $("#iniciar").click(function(){
  
      var username = $('#username').val();
    var password = $('#password').val();
    var remember_me = $('#input-local-storage').prop('checked');
    if(username && password) {
        console.log("Will try to login with ", username, password);
        $('#modal-error').addClass('d-invisible');
        $.ajax({
            url: g_urls.login,
            method: "POST",
            data: {
                username: username,
                password: password,
                csrfmiddlewaretoken: g_csrftoken
            }
        }).done(function(data) {
           
            g_auth = {
                username: username,
                key: data.key,
                remember_me: remember_me
            };  
            g_csrftoken = getCookie('csrftoken');
            document.location.href="panel/";
        }).fail(function(data) {
          $("#error").show();
           setTimeout(function(){ $("#error").css("display","none"); }, 2000);
        });
    } 
    else { $('#modal-error').removeClass('d-invisible');
    }

    

    });
});
</script>
</body>
</html>